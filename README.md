本地gitea服务器突然坏了,抢救出来的代码
----

# processAVIWithXorm

processA(audio)V(video)I(image)With~~Xorm~~

# 升级go版本

```shell
go install golang.org/dl/go1.21.0@latest
GOPATH/bin/go1.21.0 download
echo "PATH=/Users/zen/sdk/go1.21.0/bin:$PATH" >> ~/.bash_profile
```

# git http 记住密码

```shell
git config --global credential.helper store
git config credential.helper store
```

# 运行一个单元测试
```bash
go test -v -run <测试函数名> <目录>
# example
go test -v -run  TestRename ./
```

# 转换为本地gitea托管前的提交
```shell
git log --pretty=format:"%ai , %an: %s" --since="100 day ago" >> ./commit.log
```
```text2023-10-29 12:55:00 +0800 , zen: Merge branch 'bilibili'
2023-10-29 12:53:56 +0800 , zen: save
2023-10-29 12:53:36 +0800 , zen: Merge branch 'media'
2023-10-29 12:48:49 +0800 , zen: channel模型
2023-10-29 12:47:42 +0800 , zen: save
2023-10-29 11:24:32 +0800 , zen: save
2023-10-28 18:24:43 +0800 , zen: 更新merge方法
2023-10-28 18:20:40 +0800 , zen: 提取音频方法
2023-10-28 18:06:35 +0800 , zen: 视频和图片基本完成
2023-10-28 01:57:47 +0800 , zen: 设置lfs
2023-10-26 23:17:23 +0800 , zen: 使用大佬的协程
2023-10-26 15:19:07 +0800 , zen: 解决goto
2023-10-26 10:13:28 +0800 , zen: 经过大佬指点的协程方案
2023-10-24 01:53:06 +0800 , zen: 模拟了一个可以正确控制并发的channel
2023-10-24 00:05:13 +0800 , zen: 删除其他逻辑
2023-10-23 23:30:49 +0800 , zen: 暂时删除其他逻辑
2023-10-23 10:41:10 +0800 , 张zen: 添加说明
2023-10-23 10:37:06 +0800 , 张zen: Merge remote-tracking branch 'origin/bilibili' into bilibili
2023-10-23 10:33:45 +0800 , 张zen: 测试最大允许的长度
2023-10-23 10:33:45 +0800 , 张zen: 测试最大允许的长度
2023-10-23 10:26:30 +0800 , 张zen: 每个汉字三个字符长度
2023-10-23 10:16:59 +0800 , 张zen: 截取过长文件名
2023-10-23 10:10:00 +0800 , 张zen: init
2023-10-23 10:08:14 +0800 , 张zen: init
2023-10-23 10:04:58 +0800 , 张zen: init
2023-10-23 18:02:42 +0800 , root: Initial commit
# 清空了历史提交记录
2023-10-06 11:12:41 +0800 , 张zen: 静态动态图片使用同一个表记录
2023-10-06 11:12:07 +0800 , 张zen: 数据表同步提供状态输出
2023-10-06 10:34:11 +0800 , 张zen: yt-dlp
2023-10-06 09:18:39 +0800 , 张zen: save
2023-10-04 19:51:08 +0800 , 张zen: 更新关联方法
2023-10-04 18:39:10 +0800 , 张zen: 直接从mediainfo获取视频帧数
2023-10-04 16:46:32 +0800 , 张zen: 防止查找失败溢出
2023-10-04 16:43:57 +0800 , 张zen: 快速获取帧数需要在转码命令前被运行,还未解决
2023-10-04 16:41:53 +0800 , 张zen: 视频模块使用任务表-子任务表模式
2023-10-03 20:17:41 +0800 , 张zen: 读写锁示例
2023-10-03 20:17:22 +0800 , 张zen: 设置日志文件不可删除
2023-10-03 18:34:30 +0800 , 张zen: save
2023-10-03 18:21:36 +0800 , 张zen: 字符串切片去重
2023-10-02 19:50:41 +0800 , 张zen: save
2023-10-01 12:10:51 +0800 , zen: save
2023-09-29 22:09:04 +0800 , zen: dos2unix
2023-09-29 20:41:12 +0800 , zen: dos2unix
2023-09-29 20:26:22 +0800 , zen: save
2023-09-29 20:24:00 +0800 , zen: 随机数工具
2023-09-28 21:32:20 +0800 , zen: ffmpeg 添加截取说明
2023-09-28 18:51:32 +0800 , zen: 视频删除章节信息
2023-09-25 14:11:08 +0800 , zen: 完善重命名方式
2023-09-25 11:39:18 +0800 , zen: Windows下退出
2023-09-21 21:42:12 +0800 , zen: save
2023-09-21 17:29:16 +0800 , zen: 图片重命名
2023-09-21 09:44:22 +0800 , zen: save
2023-09-19 23:12:41 +0800 , zen: 增大电平
2023-09-19 20:47:50 +0800 , zen: 增加有声小说音频文件电平
2023-09-19 20:24:52 +0800 , zen: 使用正则表达式替代合法文件名的replace方法
2023-09-19 11:14:35 +0800 , zen: 跳过非法文件名
2023-09-19 11:13:14 +0800 , zen: utf8mb4
2023-09-19 11:07:44 +0800 , zen: fix
2023-09-19 11:04:06 +0800 , zen: entry保留原始数据
2023-09-19 10:18:13 +0800 , zen: panic测试
2023-09-19 09:52:42 +0800 , zen:  import cycle not allowed
2023-09-19 09:37:48 +0800 , zen: 保存原始entry文件
2023-09-19 09:24:32 +0800 , zen: bilibili如果name和partname一致，仅保留一种
2023-09-19 08:46:23 +0800 , zen: save
2023-09-19 08:43:00 +0800 , zen: for bilibili
2023-09-17 22:15:13 +0800 , zen: save
2023-09-17 21:19:13 +0800 , zen: 尽可能地不使用go module
2023-09-17 20:44:47 +0800 , zen: 使用log.slog
2023-09-17 20:34:59 +0800 , zen: 动图统一转换为gif avif无法处理透明图
2023-09-17 19:47:57 +0800 , zen: 吃饭
2023-09-17 19:34:03 +0800 , zen: save
2023-09-17 19:33:46 +0800 , zen: 明确文件夹递归函数不包括本身文件夹
2023-09-17 19:33:13 +0800 , zen: 发送邮件函数改为变参函数
2023-09-17 18:57:01 +0800 , zen: 实现音频部分任务表分离
2023-09-17 10:41:20 +0800 , zen: 跳过已经加速的文件夹
2023-09-16 14:28:06 +0800 , zen: rename
2023-09-16 13:07:09 +0800 , zen: rename
2023-09-16 12:03:02 +0800 , zen: 重命名功能分函数
2023-09-16 12:02:40 +0800 , zen: 数据库写入使用协程
2023-09-14 18:26:39 +0800 , zen: 新生成二进制可执行文件
2023-09-13 11:19:33 +0800 , zen: save
2023-09-12 13:25:46 +0800 , zen: 添加文件列表去重功能
2023-09-12 11:13:59 +0800 , zen: go get -u
2023-09-12 11:08:33 +0800 , zen: aac转换时重命名
2023-09-12 10:37:01 +0800 , zen: save
2023-09-10 16:10:03 +0800 , zen: 添加新电子邮件
2023-09-09 21:34:03 +0800 , zen: save
2023-09-09 17:50:47 +0800 , zen: Merge remote-tracking branch 'origin/master'
2023-09-09 17:50:10 +0800 , zen: 添加获取asmr网站的方案
2023-09-09 17:48:01 +0800 , zen: 添加通用的按行写文件方法
2023-09-07 17:36:58 +0800 , zen: Amazon AI 生成
2023-09-07 12:16:18 +0800 , zen: 删除冗余部分
2023-09-04 22:49:02 +0800 , zen: bilibili自带即为h265无需重编码
2023-09-03 13:12:56 +0800 , zen: save
2023-09-02 16:06:22 +0800 , zen: 更改了video获取文件夹的方法 待测试
2023-09-02 12:25:49 +0800 , zen: AVmerge长文件名会导致错误
2023-08-25 17:13:07 +0800 , zen: 快捷命令
2023-08-25 17:00:46 +0800 , zen: 程序升级1.21.0 每次运行后自动编译新版本二进制文件
2023-08-22 15:33:38 +0800 , zen: 快速修改视频尺寸 不转码
2023-08-22 01:28:40 +0800 , zen: 二进制可执行文件
2023-08-20 17:35:41 +0800 , zen: init
2023-08-20 17:28:32 +0800 , root: Initial commit2023-10-06 11:12:41 +0800 , 张zen: 静态动态图片使用同一个表记录
2023-10-06 11:12:07 +0800 , 张zen: 数据表同步提供状态输出
2023-10-06 10:34:11 +0800 , 张zen: yt-dlp
2023-10-06 09:18:39 +0800 , 张zen: save
2023-10-04 19:51:08 +0800 , 张zen: 更新关联方法
2023-10-04 18:39:10 +0800 , 张zen: 直接从mediainfo获取视频帧数
2023-10-04 16:46:32 +0800 , 张zen: 防止查找失败溢出
2023-10-04 16:43:57 +0800 , 张zen: 快速获取帧数需要在转码命令前被运行,还未解决
2023-10-04 16:41:53 +0800 , 张zen: 视频模块使用任务表-子任务表模式
2023-10-03 20:17:41 +0800 , 张zen: 读写锁示例
2023-10-03 20:17:22 +0800 , 张zen: 设置日志文件不可删除
2023-10-03 18:34:30 +0800 , 张zen: save
2023-10-03 18:21:36 +0800 , 张zen: 字符串切片去重
2023-10-02 19:50:41 +0800 , 张zen: save
2023-10-01 12:10:51 +0800 , zen: save
2023-09-29 22:09:04 +0800 , zen: dos2unix
2023-09-29 20:41:12 +0800 , zen: dos2unix
2023-09-29 20:26:22 +0800 , zen: save
2023-09-29 20:24:00 +0800 , zen: 随机数工具
2023-09-28 21:32:20 +0800 , zen: ffmpeg 添加截取说明
2023-09-28 18:51:32 +0800 , zen: 视频删除章节信息
2023-09-25 14:11:08 +0800 , zen: 完善重命名方式
2023-09-25 11:39:18 +0800 , zen: Windows下退出
2023-09-21 21:42:12 +0800 , zen: save
2023-09-21 17:29:16 +0800 , zen: 图片重命名
2023-09-21 09:44:22 +0800 , zen: save
2023-09-19 23:12:41 +0800 , zen: 增大电平
2023-09-19 20:47:50 +0800 , zen: 增加有声小说音频文件电平
2023-09-19 20:24:52 +0800 , zen: 使用正则表达式替代合法文件名的replace方法
2023-09-19 11:14:35 +0800 , zen: 跳过非法文件名
2023-09-19 11:13:14 +0800 , zen: utf8mb4
2023-09-19 11:07:44 +0800 , zen: fix
2023-09-19 11:04:06 +0800 , zen: entry保留原始数据
2023-09-19 10:18:13 +0800 , zen: panic测试
2023-09-19 09:52:42 +0800 , zen:  import cycle not allowed
2023-09-19 09:37:48 +0800 , zen: 保存原始entry文件
2023-09-19 09:24:32 +0800 , zen: bilibili如果name和partname一致，仅保留一种
2023-09-19 08:46:23 +0800 , zen: save
2023-09-19 08:43:00 +0800 , zen: for bilibili
2023-09-17 22:15:13 +0800 , zen: save
2023-09-17 21:19:13 +0800 , zen: 尽可能地不使用go module
2023-09-17 20:44:47 +0800 , zen: 使用log.slog
2023-09-17 20:34:59 +0800 , zen: 动图统一转换为gif avif无法处理透明图
2023-09-17 19:47:57 +0800 , zen: 吃饭
2023-09-17 19:34:03 +0800 , zen: save
2023-09-17 19:33:46 +0800 , zen: 明确文件夹递归函数不包括本身文件夹
2023-09-17 19:33:13 +0800 , zen: 发送邮件函数改为变参函数
2023-09-17 18:57:01 +0800 , zen: 实现音频部分任务表分离
2023-09-17 10:41:20 +0800 , zen: 跳过已经加速的文件夹
2023-09-16 14:28:06 +0800 , zen: rename
2023-09-16 13:07:09 +0800 , zen: rename
2023-09-16 12:03:02 +0800 , zen: 重命名功能分函数
2023-09-16 12:02:40 +0800 , zen: 数据库写入使用协程
2023-09-14 18:26:39 +0800 , zen: 新生成二进制可执行文件
2023-09-13 11:19:33 +0800 , zen: save
2023-09-12 13:25:46 +0800 , zen: 添加文件列表去重功能
2023-09-12 11:13:59 +0800 , zen: go get -u
2023-09-12 11:08:33 +0800 , zen: aac转换时重命名
2023-09-12 10:37:01 +0800 , zen: save
2023-09-10 16:10:03 +0800 , zen: 添加新电子邮件
2023-09-09 21:34:03 +0800 , zen: save
2023-09-09 17:50:47 +0800 , zen: Merge remote-tracking branch 'origin/master'
2023-09-09 17:50:10 +0800 , zen: 添加获取asmr网站的方案
2023-09-09 17:48:01 +0800 , zen: 添加通用的按行写文件方法
2023-09-07 17:36:58 +0800 , zen: Amazon AI 生成
2023-09-07 12:16:18 +0800 , zen: 删除冗余部分
2023-09-04 22:49:02 +0800 , zen: bilibili自带即为h265无需重编码
2023-09-03 13:12:56 +0800 , zen: save
2023-09-02 16:06:22 +0800 , zen: 更改了video获取文件夹的方法 待测试
2023-09-02 12:25:49 +0800 , zen: AVmerge长文件名会导致错误
2023-08-25 17:13:07 +0800 , zen: 快捷命令
2023-08-25 17:00:46 +0800 , zen: 程序升级1.21.0 每次运行后自动编译新版本二进制文件
2023-08-22 15:33:38 +0800 , zen: 快速修改视频尺寸 不转码
2023-08-22 01:28:40 +0800 , zen: 二进制可执行文件
2023-08-20 17:35:41 +0800 , zen: init
2023-08-20 17:28:32 +0800 , root: Initial commit
2023-08-20 17:30:29 +0800 , zen: 同时修改声道
2023-08-11 10:08:03 +0800 , zen: 数据库超时五秒
2023-08-10 22:47:36 +0800 , zen: 数据库连接使用超时控制
2023-08-10 21:44:34 +0800 , zen: 空结构体控制协程并发数量
2023-08-10 21:43:43 +0800 , zen: 使用协程启动mysql,如果链接失败直接修改配置文件阻止写入动作
2023-08-09 16:56:33 +0800 , zen: 硬件加速导致画质降低 体积增大
2023-08-09 16:56:13 +0800 , zen: 简单粗暴合并bilibili视频
2023-08-08 19:52:19 +0800 , zen: 使用合理的硬件加速
2023-08-07 23:49:46 +0800 , zen: 批量修改文件名 小程序
2023-08-07 16:22:17 +0800 , zen: save
2023-08-06 11:45:21 +0800 , zen: save
2023-08-06 11:20:58 +0800 , zen: bilibili on root
2023-08-04 17:42:56 +0800 , zen: 超时控制
2023-08-04 17:35:07 +0800 , zen: 延时命令结束后记录最后的操作
2023-08-03 11:37:00 +0800 , zen: save
2023-07-31 12:11:20 +0800 , zen: 音频文件转换为单声道
2023-07-31 11:33:20 +0800 , zen: 新增q换行当前转码后直接退出功能
2023-07-31 11:06:35 +0800 , zen: 添加统一mysql开关
2023-07-30 14:39:41 +0800 , zen: save
2023-07-29 08:30:38 +0800 , zen:   转换同时使用单声道
2023-07-28 18:15:35 +0800 , zen: 执行命令统一提示
2023-07-28 18:15:07 +0800 , zen: 等待30秒后退出程序
2023-07-28 18:14:33 +0800 , zen: 手工填写加速参数 防止多次加速 保留原始文件
2023-07-27 20:28:37 +0800 , zen: fix
2023-07-27 17:39:16 +0800 , zen: 升级依赖要慎重
2023-07-27 17:23:27 +0800 , zen: 会直接退出
2023-07-27 07:18:48 +0800 , zen: save
2023-07-25 21:11:28 +0800 , zen: 加速音频全部子文件夹
2023-07-22 17:09:36 +0800 , zen: 添加视频提取音频的功能
2023-07-21 17:24:21 +0800 , zen: 扫描文件后批量插入数据库
2023-07-20 22:56:00 +0800 , zen: save
2023-07-18 19:51:44 +0800 , zen: 使用正规int64转换string方法
2023-07-18 19:42:44 +0800 , zen: 查漏补缺
2023-07-18 18:49:16 +0800 , zen: 命令执行函数提取出来 作为单独的函数
2023-07-18 16:56:04 +0800 , zen: fix
2023-07-15 20:24:24 +0800 , zen: 可以正常运行
2023-07-13 20:28:34 +0800 , zen: save
2023-07-13 17:39:29 +0800 , zen: 如果数据库连接出错,后期不再尝试写入
2023-07-13 17:31:02 +0800 , zen: 提取aac写入数据库判断是否有连接
2023-07-13 17:28:56 +0800 , zen: telegram写入数据库判断是否有连接
2023-07-13 16:44:27 +0800 , zen: update
2023-07-06 14:09:53 +0800 , zen: fork的代码库残留tag会导致go get -u 问题
2023-07-06 12:25:05 +0800 , zen: 兼容两种格式
2023-07-04 15:02:53 +0800 , zen: 正式添加哔哩哔哩提取音频
2023-07-03 20:31:41 +0800 , zen: 简易爬虫
2023-07-03 18:15:16 +0800 , zen: 测试通过
2023-07-03 17:54:59 +0800 , zen: 任务完成发送总结邮件
2023-07-03 17:39:21 +0800 , zen: speedUp不关注控制台
2023-07-03 15:01:19 +0800 , zen: 准备添加程序结束后的总结
2023-07-03 01:16:47 +0800 , zen: 实现批量下载
2023-07-02 18:36:17 +0800 , zen: 创建单独文件夹存放图片
2023-07-02 18:27:49 +0800 , zen: 添加数据库支持
2023-07-02 17:22:42 +0800 , zen: 可以正确解析
2023-07-02 16:02:24 +0800 , zen: 快速获取Telegraph图片
2023-07-01 03:20:58 +0800 , zen: 跳过
2023-06-25 16:22:57 +0800 , zen: 视频文件如果就在h265文件夹里 跳过
2023-06-22 18:21:24 +0800 , zen: 创建文件夹不报错
2023-06-22 13:55:59 +0800 , zen: save
2023-06-22 13:48:11 +0800 , zen: save
2023-06-21 21:30:44 +0800 , zen: save
2023-06-21 13:36:47 +0800 , zen: save
2023-06-21 10:28:46 +0800 , zen: 图片处理可以获得正确文件大小
2023-06-20 20:55:39 +0800 , 张益铭: GetAll方法有问题待修改
2023-06-20 20:43:36 +0800 , 张益铭: 全部改为引用传递
2023-06-20 17:21:16 +0800 , 张益铭: 全部换成引用传递
2023-06-20 17:18:08 +0800 , 张益铭: 写入数据库必须使用引用传递
2023-06-20 14:00:31 +0800 , 张益铭: save
2023-06-20 14:00:13 +0800 , 张益铭: 文件大小使用原始字节数
2023-06-20 13:59:42 +0800 , 张益铭: addTag记录到数据库
2023-06-20 12:54:55 +0800 , 张益铭: 恢复创建输出文件夹,准备排查不能获取文件大小的问题
2023-06-19 19:03:22 +0800 , zen: strings.Trim 会丢失字符
2023-06-18 22:24:45 +0800 , zen: save
2023-06-17 21:47:10 +0800 , zen: 图片错误记录到数据库
2023-06-16 17:19:50 +0800 , zen: 尝试不关心输出内容
2023-06-16 12:36:39 +0800 , zen: 清空数据库,等待第一次测试
2023-06-16 12:34:04 +0800 , zen: clean
2023-06-16 12:32:18 +0800 , zen: 等待测试
2023-06-16 10:56:49 +0800 , zen: 分表
2023-06-16 10:47:23 +0800 , zen: 视频修改比例任务添加说明
2023-06-16 10:45:28 +0800 , zen: 视频旋转任务添加说明
2023-06-16 10:41:04 +0800 , zen: fix
2023-06-16 10:40:11 +0800 , zen: resize任务添加说明
2023-06-16 10:39:52 +0800 , zen: fix
2023-06-16 10:30:28 +0800 , zen: 视频转h265添加说明
2023-06-16 10:22:36 +0800 , zen: 统一函数名称
2023-06-16 10:15:14 +0800 , zen: 音频编码aac任务添加说明
2023-06-16 10:13:01 +0800 , zen: 音频加速任务添加任务说明
2023-06-16 10:12:39 +0800 , zen: 图片任务添加任务说明
2023-06-16 09:54:16 +0800 , zen: 重命名
2023-06-16 09:53:50 +0800 , zen: 统一函数名称
2023-06-16 09:47:56 +0800 , zen: 重命名
2023-06-16 09:47:17 +0800 , zen: 图片类任务添加任务种类
2023-06-16 09:45:57 +0800 , zen: 数据表添加任务种类
2023-06-16 00:28:09 +0800 , zen: 今日结束
2023-06-15 22:47:48 +0800 , zen: 阶段保存
2023-06-15 13:32:56 +0800 , zen: 文件记录到数据库基本实现
2023-06-14 23:23:07 +0800 , zen: 数据库方面基本跑通
2023-06-14 22:09:47 +0800 , zen: Initial commit
```